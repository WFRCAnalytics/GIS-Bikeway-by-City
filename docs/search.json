[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Analyzing the Utah Bikeways data",
    "section": "",
    "text": "This analysis examines the distribution of roadway and bikeway infrastructure across Utah municipalities. The primary objectives are to:\n\nCalculate total road lane miles for each municipality\nCalculate bikeway lane miles by facility type for each municipality\nCompare roadway and bikeway infrastructure across municipalities\n\nAll spatial data is sourced from the Utah Geospatial Resource Center (UGRC) and processed using the R spatial ecosystem."
  },
  {
    "objectID": "index.html#install-packages",
    "href": "index.html#install-packages",
    "title": "Analyzing the Utah Bikeways data",
    "section": "\n2.1 Install Packages",
    "text": "2.1 Install Packages\nThe following packages are required for this analysis. Install them if not already available in your R environment.\ninstall.packages(\"dplyr\")\ninstall.packages(\"tidyr\")\ninstall.packages(\"readr\")\ninstall.packages(\"forcats\")\ninstall.packages(\"fs\")\ninstall.packages(\"sf\")\ninstall.packages(\"arcgislayers\")\ninstall.packages(\"janitor\")\ninstall.packages(\"units\")\ninstall.packages(\"tmap\")"
  },
  {
    "objectID": "index.html#load-packages",
    "href": "index.html#load-packages",
    "title": "Analyzing the Utah Bikeways data",
    "section": "\n2.2 Load Packages",
    "text": "2.2 Load Packages\n\nShow the codelibrary(dplyr) # for data manipulation\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nShow the codelibrary(tidyr) # for tidy data operations (pivot functions)\nlibrary(readr) # read and write tabular data\nlibrary(forcats) # process categorical data\nlibrary(fs) # for file system management\nlibrary(sf) # for simple feature geometries\n\nLinking to GEOS 3.13.1, GDAL 3.11.0, PROJ 9.6.0; sf_use_s2() is TRUE\n\nShow the codelibrary(arcgislayers) # to read arcgis rest services\nlibrary(janitor) # clean column names\n\n\nAttaching package: 'janitor'\n\n\nThe following objects are masked from 'package:stats':\n\n    chisq.test, fisher.test\n\nShow the codelibrary(units) # set and adjust units of measurement\n\nudunits database from C:/Users/Pukar.Bhandari/AppData/Local/R/win-library/4.5/units/share/udunits/udunits2.xml\n\nShow the codelibrary(tmap) # view sf objects"
  },
  {
    "objectID": "index.html#environment-variables",
    "href": "index.html#environment-variables",
    "title": "Analyzing the Utah Bikeways data",
    "section": "\n2.3 Environment Variables",
    "text": "2.3 Environment Variables\nWe use EPSG:3566 (NAD83(HARN) / Utah North) projection, which uses US survey feet as the base unit. This projection is appropriate for statewide analysis in Utah and ensures accurate distance calculations.\n\nShow the code# Set Project CRS\nPROJECT_CRS = \"EPSG:3566\"\n\n# Set tmap mode to interactive\ntmap::tmap_mode(\"view\")\n\nℹ tmap modes \"plot\" - \"view\"\nℹ toggle with `tmap::ttm()`"
  },
  {
    "objectID": "index.html#utah-city-boundaries",
    "href": "index.html#utah-city-boundaries",
    "title": "Analyzing the Utah Bikeways data",
    "section": "\n3.1 Utah City Boundaries",
    "text": "3.1 Utah City Boundaries\nMunicipal boundaries are used to aggregate roadway and bikeway data by city. These boundaries represent the legal limits of incorporated municipalities in Utah.\n\nShow the code# Define paths\npath_ut_cities &lt;- file.path(dir_data, \"UtahMunicipalBoundaries.gdb\")\n\n# Download if not exists\nif (!fs::file_exists(path_ut_cities)) {\n  # Read data using arcgis package\n  sf_ut_cities &lt;- arcgislayers::arc_read(\n    \"https://services1.arcgis.com/99lidPhWCzftIe9K/ArcGIS/rest/services/UtahMunicipalBoundaries/FeatureServer/0\",\n    crs = PROJECT_CRS\n  ) |&gt; janitor::clean_names()\n  # Write to a GeoDatabase\n  sf_ut_cities |&gt;\n    sf::st_write(path_ut_cities, layer = \"UtahMunicipalBoundaries\", append = FALSE)\n} else {\n  # Read from local copy\n  sf_ut_cities &lt;- sf::st_read(path_ut_cities) |&gt;\n    sf::st_transform(PROJECT_CRS)\n}\n\nReading layer `UtahMunicipalBoundaries' from data source \n  `D:\\GitHub\\GIS-Bikeway-by-City\\_data\\UGRC\\UtahMunicipalBoundaries.gdb' \n  using driver `OpenFileGDB'\nSimple feature collection with 259 features and 17 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 934991.8 ymin: 6077738 xmax: 2272474 ymax: 7898798\nProjected CRS: NAD83 / Utah Central (ftUS)\n\n\n\nShow the codetmap::qtm(sf_ut_cities)"
  },
  {
    "objectID": "index.html#utah-roadways",
    "href": "index.html#utah-roadways",
    "title": "Analyzing the Utah Bikeways data",
    "section": "\n3.2 Utah Roadways",
    "text": "3.2 Utah Roadways\nThe Utah Roads dataset contains all roadway centerlines statewide, including the number of through lanes for each road segment. This forms the basis for calculating road lane miles.\n\nShow the code# Define paths\npath_ut_roads &lt;- file.path(dir_data, \"UtahRoads.gdb\")\n\n# Download if not exists\nif (!fs::file_exists(path_ut_roads)) {\n  # Read data using arcgis package\n  sf_ut_roads &lt;- arcgislayers::arc_read(\n    \"https://services1.arcgis.com/99lidPhWCzftIe9K/ArcGIS/rest/services/UtahRoads/FeatureServer/0\",\n    crs = PROJECT_CRS\n  ) |&gt; janitor::clean_names()\n  # Write to a GeoDatabase\n  sf_ut_roads |&gt;\n    sf::st_write(path_ut_roads, layer = \"UtahRoads\", append = FALSE)\n} else {\n  # Read from local copy\n  sf_ut_roads &lt;- sf::st_read(path_ut_roads) |&gt;\n    sf::st_transform(PROJECT_CRS)\n}\n\nReading layer `UtahRoads' from data source \n  `D:\\GitHub\\GIS-Bikeway-by-City\\_data\\UGRC\\UtahRoads.gdb' using driver `OpenFileGDB'\nSimple feature collection with 410604 features and 86 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 895206.4 ymin: 6071653 xmax: 2356671 ymax: 7904448\nProjected CRS: NAD83 / Utah Central (ftUS)\n\n\n\nShow the codetmap::qtm(sf_ut_roadways)"
  },
  {
    "objectID": "index.html#utah-bikeways",
    "href": "index.html#utah-bikeways",
    "title": "Analyzing the Utah Bikeways data",
    "section": "\n3.3 Utah Bikeways",
    "text": "3.3 Utah Bikeways\nThe Bikeways dataset contains all existing bicycle facilities in Utah. Each segment has two facility type attributes (facility1 and facility2) representing the bicycle facility in each direction of travel.\n\nShow the code# Define paths\npath_ut_bikeways &lt;- file.path(dir_data, \"Bikeways.gdb\")\n\n# Download if not exists\nif (!fs::file_exists(path_ut_bikeways)) {\n  # Read data using arcgis package\n  sf_ut_bikeways &lt;- arcgislayers::arc_read(\n    \"https://services1.arcgis.com/99lidPhWCzftIe9K/ArcGIS/rest/services/Bikeways/FeatureServer/0\",\n    crs = PROJECT_CRS\n  ) |&gt; janitor::clean_names()\n  # Write to a GeoDatabase\n  sf_ut_bikeways |&gt;\n    sf::st_write(path_ut_bikeways, layer = \"Bikeways\", append = FALSE)\n} else {\n  # Read from local copy\n  sf_ut_bikeways &lt;- sf::st_read(path_ut_bikeways) |&gt;\n    sf::st_transform(PROJECT_CRS)\n}\n\nReading layer `Bikeways' from data source \n  `D:\\GitHub\\GIS-Bikeway-by-City\\_data\\UGRC\\Bikeways.gdb' using driver `OpenFileGDB'\nSimple feature collection with 101693 features and 12 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 896123 ymin: 6076384 xmax: 2356440 ymax: 7904448\nProjected CRS: NAD83 / Utah Central (ftUS)\n\n\n\nShow the codetmap::qtm(sf_ut_bikeways)"
  },
  {
    "objectID": "index.html#calculate-lane-miles",
    "href": "index.html#calculate-lane-miles",
    "title": "Analyzing the Utah Bikeways data",
    "section": "\n4.1 Calculate Lane Miles",
    "text": "4.1 Calculate Lane Miles\nRoad lane miles are calculated by multiplying the length of each road segment by the number of through lanes. For road segments where the through lane count is missing (NA), we assume 1 lane as a conservative estimate.\nThe calculation converts the geometry length from US survey feet to miles using the units package, which properly handles unit conversions and maintains unit awareness throughout the analysis.\n\nShow the codesf_ut_roads &lt;- sf_ut_roads |&gt;\n    dplyr::mutate(\n        # TODO: fix thrulanes data\n        dot_thrulanes = dplyr::if_else(is.na(dot_thrulanes), 1, dot_thrulanes),\n        miles = units::set_units(sf::st_length(`SHAPE`), \"mile\"),\n        lane_miles = units::set_units(dot_thrulanes * miles, \"mile\")\n    )\n\nsf_ut_roads |&gt;\n  dplyr::select(dot_thrulanes, miles, lane_miles) |&gt;\n  head(20)\n\nSimple feature collection with 20 features and 3 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 1525086 ymin: 6823427 xmax: 1690992 ymax: 7058250\nProjected CRS: NAD83 / Utah Central (ftUS)\nFirst 10 features:\n   dot_thrulanes             miles        lane_miles\n1              1 1.52909874 [mile] 1.52909874 [mile]\n2              1 2.86144968 [mile] 2.86144968 [mile]\n3              1 1.06293998 [mile] 1.06293998 [mile]\n4              1 0.80867386 [mile] 0.80867386 [mile]\n5              1 0.71336950 [mile] 0.71336950 [mile]\n6              1 0.36598669 [mile] 0.36598669 [mile]\n7              1 0.09770893 [mile] 0.09770893 [mile]\n8              1 0.25556167 [mile] 0.25556167 [mile]\n9              1 1.16984782 [mile] 1.16984782 [mile]\n10             1 0.30950636 [mile] 0.30950636 [mile]\n                            SHAPE\n1  MULTILINESTRING ((1580305 6...\n2  MULTILINESTRING ((1582439 6...\n3  MULTILINESTRING ((1585991 6...\n4  MULTILINESTRING ((1655301 7...\n5  MULTILINESTRING ((1548359 6...\n6  MULTILINESTRING ((1614298 6...\n7  MULTILINESTRING ((1606261 7...\n8  MULTILINESTRING ((1606826 6...\n9  MULTILINESTRING ((1525086 6...\n10 MULTILINESTRING ((1616278 6..."
  },
  {
    "objectID": "index.html#aggregate-by-municipality",
    "href": "index.html#aggregate-by-municipality",
    "title": "Analyzing the Utah Bikeways data",
    "section": "\n4.2 Aggregate by Municipality",
    "text": "4.2 Aggregate by Municipality\nUsing spatial join, we associate each road segment with its municipality and sum the lane miles. Roads that fall outside municipal boundaries will have NA for city_name.\n\nShow the code# Calculate total lane miles by municipality\nroad_miles_by_city &lt;- sf_ut_roads |&gt;\n\n    # Spatial join: attach each road segment to the city it falls within\n    sf::st_join(\n      sf_ut_cities |&gt;\n        dplyr::rename(`city_name` = `name`) |&gt;\n        dplyr::select(`city_name`),\n      join = sf::st_intersects\n    ) |&gt;\n\n    # Group and summarize: total lane miles per city\n    dplyr::group_by(city_name) |&gt;\n    dplyr::summarize(\n      total_lane_miles = sum(lane_miles, na.rm = TRUE),\n      .groups = \"drop\"\n    ) |&gt;\n\n    # Output as a non-spatial table\n    sf::st_drop_geometry()\n\n# View the results\nroad_miles_by_city |&gt;\n  dplyr::arrange(dplyr::desc(total_lane_miles))\n\n# A tibble: 256 × 2\n   city_name        total_lane_miles\n   &lt;chr&gt;                      [mile]\n 1 &lt;NA&gt;                       98275.\n 2 Salt Lake City               905.\n 3 St. George                   766.\n 4 West Valley City             478.\n 5 West Jordan                  475.\n 6 Lehi                         423.\n 7 Sandy                        417.\n 8 South Jordan                 412.\n 9 Layton                       383.\n10 Provo                        380.\n# ℹ 246 more rows\n\n\nKey Finding: Salt Lake City has the highest road lane miles among Utah municipalities, followed by St. George and West Valley City. The NA category represents roads outside municipal boundaries (unincorporated areas, state highways between cities, etc.)."
  },
  {
    "objectID": "index.html#reclassify-bikeway-types-to-categories",
    "href": "index.html#reclassify-bikeway-types-to-categories",
    "title": "Analyzing the Utah Bikeways data",
    "section": "\n5.1 Reclassify Bikeway Types to Categories",
    "text": "5.1 Reclassify Bikeway Types to Categories\nWe use forcats package to respect the hierarchy of the bicycle facilities.\n\nShow the code# Define the order of facility classes\nfacility_class_order &lt;- c(\n  \"Paved Path\",\n  \"Protected Bike Lane\",\n  \"Bike Lane\",\n  \"Marked Route\",\n  \"Unmarked Route\",\n  \"Other\"\n)\n\n# Reclassify bike facilities into broader categories as factors\nsf_ut_bikeways &lt;- sf_ut_bikeways |&gt;\n  dplyr::mutate(\n    facility1_class = dplyr::case_when(\n      facility1 == \"Trail or Pathway\" ~ \"Paved Path\",\n      facility1 %in% c(\n        \"Cycle track, at-grade, protected with parking (1A)\",\n        \"Cycle track, protected with barrier (1B)\",\n        \"Cycle track, raised and curb separated (1C)\"\n      ) ~ \"Protected Bike Lane\",\n      facility1 %in% c(\n        \"Buffered bike lane (2A)\",\n        \"Bike lane (2B)\"\n      ) ~ \"Bike Lane\",\n      facility1 %in% c(\n        \"Marked shared roadway (3B)\",\n        \"Signed shared roadway (3C)\"\n      ) ~ \"Marked Route\",\n      facility1 == \"Shoulder bikeway (3A)\" ~ \"Unmarked Route\",\n      TRUE ~ \"Other\"\n    ),\n    facility2_class = dplyr::case_when(\n      facility2 == \"Trail or Pathway\" ~ \"Paved Path\",\n      facility2 %in% c(\n        \"Cycle track, at-grade, protected with parking (1A)\",\n        \"Cycle track, protected with barrier (1B)\",\n        \"Cycle track, raised and curb separated (1C)\"\n      ) ~ \"Protected Bike Lane\",\n      facility2 %in% c(\n        \"Buffered bike lane (2A)\",\n        \"Bike lane (2B)\"\n      ) ~ \"Bike Lane\",\n      facility2 %in% c(\n        \"Marked shared roadway (3B)\",\n        \"Signed shared roadway (3C)\"\n      ) ~ \"Marked Route\",\n      facility2 == \"Shoulder bikeway (3A)\" ~ \"Unmarked Route\",\n      TRUE ~ \"Other\"\n    ),\n    # Convert to factors with proper ordering\n    facility1_class = factor(facility1_class, levels = facility_class_order),\n    facility2_class = factor(facility2_class, levels = facility_class_order)\n  )"
  },
  {
    "objectID": "index.html#calculate-bikeway-lane-miles-by-facility-type",
    "href": "index.html#calculate-bikeway-lane-miles-by-facility-type",
    "title": "Analyzing the Utah Bikeways data",
    "section": "\n5.2 Calculate Bikeway Lane Miles by Facility Type",
    "text": "5.2 Calculate Bikeway Lane Miles by Facility Type\nBikeway facilities are directional - a single bikeway segment can have different facility types in each direction (facility1 and facility2). For this analysis, we treat each direction as a separate lane, meaning a 1-mile bikeway segment with bike lanes in both directions counts as 2 lane-miles of bike lanes.\nThe pivot_longer() function stacks facility1 and facility2 into separate rows, effectively doubling the mileage for segments where both directions have facilities. We then group by municipality and facility type to calculate total lane miles for each combination.\n\nShow the code# Prepare bikeways with both directions as lanes\nbikeway_miles_by_city &lt;- sf_ut_bikeways |&gt;\n    dplyr::filter(cartocode != \"9\") |&gt; # Remove 'sidewalks' and 'virtual link' connections\n    dplyr::select(facility1_class, facility2_class) |&gt;\n\n    # Add mileage to each bikeway segment\n    dplyr::mutate(\n      miles = units::set_units(sf::st_length(SHAPE), \"mile\")\n    ) |&gt;\n\n    # Spatial join: attach each segment to the city it falls within\n    sf::st_join(\n      sf_ut_cities |&gt;\n          dplyr::rename(`city_name` = `name`) |&gt;\n          dplyr::select(`city_name`),\n      join = sf::st_intersects\n    ) |&gt;\n    sf::st_drop_geometry() |&gt;\n\n    # Treat facility1 and facility2 as separate lane directions\n    tidyr::pivot_longer(\n      cols = c(facility1_class, facility2_class),\n      values_to = \"facility_class\"\n    ) |&gt;\n\n    # Apply weighting: 1.0 for bidirectional (Paved Path), 0.5 for directional facilities\n    dplyr::mutate(\n      weighted_miles = dplyr::if_else(\n        facility_class == \"Paved Path\",\n        as.numeric(miles) * 1.0,\n        as.numeric(miles) * 0.5\n      )\n    ) |&gt;\n\n    # Summarize total lane miles by city and facility class\n    dplyr::group_by(city_name, facility_class) |&gt;\n    dplyr::summarize(\n      total_lane_miles = sum(as.numeric(weighted_miles), na.rm = TRUE),\n      .groups = \"drop\"\n    ) |&gt;\n\n    # Make facility class into columns\n    tidyr::pivot_wider(\n      names_from = facility_class,\n      values_from = total_lane_miles,\n      values_fill = 0\n    )\n\n# Add total across all bike lane types\nbikeway_miles_by_city &lt;- bikeway_miles_by_city |&gt;\n    dplyr::rowwise() |&gt;\n    dplyr::mutate(\n      `All Biking Facilities` = sum(dplyr::c_across(!city_name))\n    ) |&gt;\n    dplyr::ungroup()\n\n# View the results\nbikeway_miles_by_city |&gt;\n  dplyr::arrange(dplyr::desc(`All Biking Facilities`))\n\n# A tibble: 256 × 8\n   city_name     `Paved Path` `Bike Lane` `Unmarked Route`  Other `Marked Route`\n   &lt;chr&gt;                &lt;dbl&gt;       &lt;dbl&gt;            &lt;dbl&gt;  &lt;dbl&gt;          &lt;dbl&gt;\n 1 &lt;NA&gt;                 240.         6.17            969.  22065.         27.5  \n 2 Salt Lake Ci…        117.       131.               19.4   521.         41.3  \n 3 St. George            95.7        6.82             89.9   437.          0    \n 4 West Valley …         70.9       19.1              47.2   396.          0.697\n 5 Lehi                 157.        12.6              23.8   334.          0    \n 6 West Jordan           53.8       32.9              51.7   358.          0.130\n 7 South Jordan         107.        37.0              21.0   320.          1.28 \n 8 Provo                 97.3       51.6              19.9   264.          4.95 \n 9 Eagle Mounta…        140.         2.62             13.7   265.          0    \n10 Sandy                 33.2       23.2              34.5   317.          1.55 \n# ℹ 246 more rows\n# ℹ 2 more variables: `Protected Bike Lane` &lt;dbl&gt;,\n#   `All Biking Facilities` &lt;dbl&gt;\n\n\nKey Finding: Bikeway infrastructure varies significantly by facility type across municipalities. The dataset includes various facility types such as bike lanes, protected bike lanes, shared-use paths, and trails."
  },
  {
    "objectID": "index.html#create-multimodal-summary",
    "href": "index.html#create-multimodal-summary",
    "title": "Analyzing the Utah Bikeways data",
    "section": "\n6.1 Create Multimodal Summary",
    "text": "6.1 Create Multimodal Summary\nThe final step combines road lane miles and bikeway lane miles by facility type into a single dataset. This allows for direct comparison of roadway and bikeway infrastructure across municipalities.\nEach row represents a municipality, with columns for total road lane miles followed by columns for each bikeway facility type. Cities with zero bikeway miles for a particular facility type will show 0 in that column.\n\nShow the code# Combine with roads\ncombined_miles_by_city &lt;- road_miles_by_city |&gt;\n  # Convert road lane miles to numeric\n  dplyr::mutate(`All Roads` = as.numeric(total_lane_miles)) |&gt;\n  dplyr::select(city_name, `All Roads`) |&gt;\n  # Join with bikeway data\n  dplyr::right_join(bikeway_miles_by_city, by = \"city_name\") |&gt;\n  # Reorder columns: city_name, bike categories, total bike, then road\n  dplyr::select(\n    city_name,\n    dplyr::all_of(facility_class_order),   # bike lane categories\n    - Other,\n    # `All Biking Facilities`,\n    `All Roads`\n  ) |&gt;\n  # Round all numeric columns to one decimal\n  dplyr::mutate(dplyr::across(where(is.numeric), \\(x) round(x, 1)))\n\ncombined_miles_by_city\n\n# A tibble: 256 × 7\n   city_name     `Paved Path` `Protected Bike Lane` `Bike Lane` `Marked Route`\n   &lt;chr&gt;                &lt;dbl&gt;                 &lt;dbl&gt;       &lt;dbl&gt;          &lt;dbl&gt;\n 1 Alpine                30.1                     0         0.7              0\n 2 Alta                   0                       0         0                1\n 3 Altamont               0                       0         0                0\n 4 Alton                  0                       0         0                0\n 5 Amalga                 0.7                     0         0                0\n 6 American Fork         19.3                     2         6.9              0\n 7 Annabella              0                       0         0                0\n 8 Antimony               0                       0         0                0\n 9 Apple Valley           0                       0         0                0\n10 Aurora                 0                       0         0                0\n# ℹ 246 more rows\n# ℹ 2 more variables: `Unmarked Route` &lt;dbl&gt;, `All Roads` &lt;dbl&gt;\n\n\nKey Finding: The ratio of bikeway lane miles to road lane miles varies considerably across Utah municipalities, indicating different levels of investment in bicycle infrastructure relative to overall roadway networks."
  }
]